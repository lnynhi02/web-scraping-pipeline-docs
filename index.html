
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://lnynhi02.github.io/web-scraping-pipeline-docs/">
      
      
        <link rel="prev" href="deployment/">
      
      
      
      <link rel="icon" href="assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.9">
    
    
      
        <title>Web Scraping Pipeline Docs</title>
      
    
    
      <link rel="stylesheet" href="assets/stylesheets/main.4af4bdda.min.css">
      
        
        <link rel="stylesheet" href="assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="stylesheets/extra.css">
    
    <script>__md_scope=new URL(".",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#documentation" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="." title="Web Scraping Pipeline Docs" class="md-header__button md-logo" aria-label="Web Scraping Pipeline Docs" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Web Scraping Pipeline Docs
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Technical Documentation
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2a7 7 0 0 1 7 7c0 2.38-1.19 4.47-3 5.74V17a1 1 0 0 1-1 1H9a1 1 0 0 1-1-1v-2.26C6.19 13.47 5 11.38 5 9a7 7 0 0 1 7-7M9 21v-1h6v1a1 1 0 0 1-1 1h-4a1 1 0 0 1-1-1m3-17a5 5 0 0 0-5 5c0 2.05 1.23 3.81 3 4.58V16h4v-2.42c1.77-.77 3-2.53 3-4.58a5 5 0 0 0-5-5"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2a7 7 0 0 0-7 7c0 2.38 1.19 4.47 3 5.74V17a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1v-2.26c1.81-1.27 3-3.36 3-5.74a7 7 0 0 0-7-7M9 21a1 1 0 0 0 1 1h4a1 1 0 0 0 1-1v-1H9z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="." title="Web Scraping Pipeline Docs" class="md-nav__button md-logo" aria-label="Web Scraping Pipeline Docs" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Web Scraping Pipeline Docs
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="deployment/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Deployment
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Technical Documentation
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="." class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Technical Documentation
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#overview" class="md-nav__link">
    <span class="md-ellipsis">
      Overview
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#system-architecture" class="md-nav__link">
    <span class="md-ellipsis">
      System Architecture
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#technical-notes" class="md-nav__link">
    <span class="md-ellipsis">
      Technical Notes
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Technical Notes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-error-handling" class="md-nav__link">
    <span class="md-ellipsis">
      1. Error Handling
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-web-scraping-with-playwright" class="md-nav__link">
    <span class="md-ellipsis">
      2. Web Scraping with Playwright
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-data-processing-storage" class="md-nav__link">
    <span class="md-ellipsis">
      3. Data Processing &amp; Storage
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-timezone-management-with-pendulum" class="md-nav__link">
    <span class="md-ellipsis">
      4. Timezone Management with Pendulum
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5-data-transfer-using-xcom" class="md-nav__link">
    <span class="md-ellipsis">
      5. Data Transfer Using XCom
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#future-enhancements-limitations" class="md-nav__link">
    <span class="md-ellipsis">
      Future Enhancements &amp; Limitations
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Future Enhancements &amp; Limitations">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#limitations" class="md-nav__link">
    <span class="md-ellipsis">
      Limitations
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Limitations">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#xcom-data-size-limit" class="md-nav__link">
    <span class="md-ellipsis">
      XCom Data Size Limit
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#future-enhancements" class="md-nav__link">
    <span class="md-ellipsis">
      Future Enhancements
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Future Enhancements">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-automated-reporting-visualization" class="md-nav__link">
    <span class="md-ellipsis">
      1. Automated Reporting &amp; Visualization
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-stream-processing-for-real-time-job-scraping" class="md-nav__link">
    <span class="md-ellipsis">
      2. Stream Processing for Real-Time Job Scraping
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#conclusion" class="md-nav__link">
    <span class="md-ellipsis">
      Conclusion
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="https://github.com/lnynhi02/web-scraping-etl-pipeline" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    GitHub Repository
    
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#overview" class="md-nav__link">
    <span class="md-ellipsis">
      Overview
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#system-architecture" class="md-nav__link">
    <span class="md-ellipsis">
      System Architecture
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#technical-notes" class="md-nav__link">
    <span class="md-ellipsis">
      Technical Notes
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Technical Notes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-error-handling" class="md-nav__link">
    <span class="md-ellipsis">
      1. Error Handling
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-web-scraping-with-playwright" class="md-nav__link">
    <span class="md-ellipsis">
      2. Web Scraping with Playwright
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-data-processing-storage" class="md-nav__link">
    <span class="md-ellipsis">
      3. Data Processing &amp; Storage
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-timezone-management-with-pendulum" class="md-nav__link">
    <span class="md-ellipsis">
      4. Timezone Management with Pendulum
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5-data-transfer-using-xcom" class="md-nav__link">
    <span class="md-ellipsis">
      5. Data Transfer Using XCom
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#future-enhancements-limitations" class="md-nav__link">
    <span class="md-ellipsis">
      Future Enhancements &amp; Limitations
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Future Enhancements &amp; Limitations">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#limitations" class="md-nav__link">
    <span class="md-ellipsis">
      Limitations
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Limitations">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#xcom-data-size-limit" class="md-nav__link">
    <span class="md-ellipsis">
      XCom Data Size Limit
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#future-enhancements" class="md-nav__link">
    <span class="md-ellipsis">
      Future Enhancements
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Future Enhancements">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-automated-reporting-visualization" class="md-nav__link">
    <span class="md-ellipsis">
      1. Automated Reporting &amp; Visualization
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-stream-processing-for-real-time-job-scraping" class="md-nav__link">
    <span class="md-ellipsis">
      2. Stream Processing for Real-Time Job Scraping
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#conclusion" class="md-nav__link">
    <span class="md-ellipsis">
      Conclusion
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="documentation"><strong><em>DOCUMENTATION</em></strong></h1>
<h2 id="overview"><strong>Overview</strong></h2>
<p>This pipeline is designed to automate the extraction, processing, and storage of job postings from the TOPCV website. It ensures data is cleaned, transformed, and structured for efficient querying and analysis. The processed data can be further utilized for visualization and reporting.</p>
<p>For a step-by-step deployment guide, visit the <a href="deployment/">Deployment</a>. Happy coding!</p>
<h2 id="system-architecture"><strong>System Architecture</strong></h2>
<p align="center">
    <img src="img/pipeline.gif" alt="Pipeline" width="100%">
</p>

<ol>
<li>
<p><strong>Data Ingestion</strong>: The pipeline collects job postings from the <a href="https://www.topcv.vn/viec-lam-it">TOPCV</a> website, extracting relevant information for further processing.</p>
</li>
<li>
<p><strong>Data Processing</strong>: Extracted data is cleaned, transformed, and formatted to ensure consistency before being stored in a PostgreSQL database.</p>
</li>
<li>
<p><strong>Workflow Orchestration</strong>: Airflow manages and schedules the entire workflow, automating data extraction, processing, and storage while maintaining task dependencies and execution order.</p>
</li>
</ol>
<h2 id="technical-notes"><strong>Technical Notes</strong></h2>
<h3 id="1-error-handling"><strong><em>1. Error Handling</em></strong></h3>
<p>To ensure data integrity and prevent unnecessary execution of downstream tasks, the pipeline includes error-handling mechanisms.</p>
<p><strong>SQL File Validation:</strong> Before executing database operations, the <code>check_sql_file</code> task verifies whether the <code>postgres_query.sql</code> file contains any <code>INSERT</code> statements.</p>
<p>If the file is empty, the pipeline raises an <code>AirflowSkipException</code>, preventing unnecessary execution.</p>
<pre><code class="language-python">def check_sql_file(**kwargs):
    postgres_sql_file = os.path.join(os.path.dirname(__file__), '..', 'tmp', 'postgres_query.sql')

    if os.path.exists(postgres_sql_file) and os.path.getsize(postgres_sql_file) &gt; 0:
        logging.info(&quot;SQL file is not empty. Proceeding with execution.&quot;)
    else:
        logging.info(&quot;No SQL queries to execute.&quot;)
        raise AirflowSkipException(&quot;Skipping task because SQL file is empty&quot;)
</code></pre>
<h3 id="2-web-scraping-with-playwright"><strong><em>2. Web Scraping with Playwright</em></strong></h3>
<p>Initially, <strong>BeautifulSoup</strong> was considered for web scraping; however, due to website restrictions, <strong>Playwright</strong> was used instead.</p>
<ul>
<li><strong>Headless Mode Issues:</strong> Running Playwright in <code>headless=True</code> mode caused failures, so <code>headless=False</code> was used.</li>
<li><strong>Virtual Display Setup:</strong> To avoid UI rendering issues in a containerized environment, <code>pyvirtualdisplay</code> is installed.</li>
</ul>
<h3 id="3-data-processing-storage"><strong><em>3. Data Processing &amp; Storage</em></strong></h3>
<p>The pipeline follows a structured data processing workflow:</p>
<ul>
<li><strong>Staging Table:</strong> Data is first written to a staging table before transformation.</li>
<li><strong>Cleaning &amp; Transformation:</strong> Data is cleaned and formatted using <code>DictCursor</code> to access table columns as <em>key-value pairs</em>. Using <code>DictCursor</code> enables direct access to values, for example by calling <code>job['title']</code>, which enhances code readability and maintainability.</li>
<li><strong>Incremental Processing:</strong> Only new job postings (<code>posted_date &gt; last_processed_time</code>) are processed to avoid duplication.</li>
</ul>
<pre><code class="language-python">def clean_data(**kwargs):
    conn = get_connection()
    cur = conn.cursor(cursor_factory=DictCursor)

    query = &quot;SELECT * FROM staging_table&quot;
    last_processed_time = read_last_processed_time()

    if last_processed_time:
        query += &quot; WHERE posted_date &gt; %s&quot;
        cur.execute(query, (last_processed_time,))
    else:
        cur.execute(query)

    scraped_jobs = cur.fetchall()
    cleaned_jobs = []
    for job in scraped_jobs:
        cleaned_jobs.append({
            'title': clean_title(job['job_name']),
            'salary': clean_salary(job['salary']),
            'company': job['job_company'],
            'update': pendulum.instance(job['posted_date']).in_timezone('Asia/Ho_Chi_Minh'),
        })

    kwargs['ti'].xcom_push(key='cleaned_data', value=cleaned_jobs)
</code></pre>
<h3 id="4-timezone-management-with-pendulum"><strong><em>4. Timezone Management with Pendulum</em></strong></h3>
<p>Airflow runs all timestamps in <strong>UTC</strong> by default, which can cause inconsistencies.
To avoid this, the <strong>pendulum</strong> library ensures all timestamps are converted to <code>Asia/Ho_Chi_Minh</code>(my local timezone) before pushing data to XCom.</p>
<pre><code class="language-python">transformed_jobs.append({
    'update': pendulum.instance(job['posted_date']).in_timezone('Asia/Ho_Chi_Minh'),
    'due_date': pendulum.instance(job['due_date']).in_timezone('Asia/Ho_Chi_Minh')
})
</code></pre>
<h3 id="5-data-transfer-using-xcom"><strong><em>5. Data Transfer Using XCom</em></strong></h3>
<p>To maintain a structured data flow, <strong>Airflowâ€™s XCom</strong> is used for inter-task communication.</p>
<ul>
<li>The <code>clean_data</code> task pushes processed job postings to XCom.</li>
<li>The <code>transform_data</code> task pulls this data for further processing.</li>
<li>Finally, <code>write_sql_query</code> generates SQL commands based on transformed data.</li>
</ul>
<h2 id="future-enhancements-limitations"><strong>Future Enhancements &amp; Limitations</strong></h2>
<h3 id="limitations"><strong><em>Limitations</em></strong></h3>
<h4 id="xcom-data-size-limit">XCom Data Size Limit</h4>
<p>Airflow's XCom is designed for small data exchanges between tasks.</p>
<ul>
<li>Storing large datasets (e.g., full job listings) might have a memory overflow error.</li>
<li>Airflow XComs have a limited size and that depeonds on the database we use:<ul>
<li>The default size limit for an XCom value stored in the Airflow metadata database is 48KB.  </li>
<li>SQLite: 2GB</li>
<li>Postgres: 1GB</li>
<li>MySQL: 64KB</li>
</ul>
</li>
</ul>
<p>Ref: <a href="https://marclamberti.com/blog/airflow-xcom/#XCom_limitations" target="_blank">https://marclamberti.com/blog/airflow-xcom/#XCom_limitations</a></p>
<h3 id="future-enhancements"><strong><em>Future Enhancements</em></strong></h3>
<h4 id="1-automated-reporting-visualization">1. Automated Reporting &amp; Visualization</h4>
<p>After storing job data, the next step could be to <em>generate reports</em> or <em>integrate with BI tools</em>.  </p>
<p>ðŸ”¹ <strong>Possible options:</strong><br />
- Exporting reports to <em>Google Sheets, Excel, or PDFs</em>.<br />
- Connecting <em>PostgreSQL</em> with <em>Power BI, Metabase, or Superset</em> for visualization. </p>
<h4 id="2-stream-processing-for-real-time-job-scraping">2. Stream Processing for Real-Time Job Scraping</h4>
<p>Currently, the pipeline operates in <em>batch mode</em>, meaning job postings are scraped and processed at scheduled intervals. This may cause delays in updating the latest job listings.  </p>
<p>ðŸ”¹ <strong>Enhancement</strong>: Introduce <em>stream processing</em> to handle job postings in real time.  </p>
<p><strong>Approach</strong><br />
- Continuously monitor job listings for updates.<br />
- Trigger data ingestion as soon as a new job posting appears.<br />
- Store real-time data in a temporary location (e.g., <strong>Kafka, Redis, or a staging table</strong>).  </p>
<p><strong>Hybrid Processing</strong><br />
- <strong>Streaming Mode</strong>: Ingest and process new postings in real-time.<br />
- <strong>Batch Mode</strong>: Run scheduled jobs for historical data analysis and reporting.  </p>
<h3 id="conclusion"><strong><em>Conclusion</em></strong></h3>
<p>Although this pipeline still has limitations and room for improvement, it has been a great learning experience. It pushed me to think about error handling, data flow between tasks, and different ways to utilize Airflow more effectively. Most importantly, this pipeline helped me develop problem-solving skillsâ€”thinking critically and exploring alternative approaches when tackling challenges.</p>
<p>There is no bestâ€”only better, and the same applies to this pipeline. Every challenge has been a step toward improvement, and each iteration brings new insights, reinforcing the mindset that continuous learning and refinement are key to building robust data workflows.s</p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": ".", "features": ["navigation.sections", "navigation.top"], "search": "assets/javascripts/workers/search.f8cc74c7.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="assets/javascripts/bundle.c8b220af.min.js"></script>
      
    
  </body>
</html>